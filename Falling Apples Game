import random
import arcade

WIDTH = 1000
HEIGHT = 650

player_x = WIDTH/2
player_y = HEIGHT/2

timer = 0.0

apples_in_trees_list = []
fallen_apples_list = []

fallen_apples_counter = 0

# controls
up_is_being_pressed = False
down_is_being_pressed = False
left_pressed = False
right_pressed = False


def stopwatch():
    minutes = int(timer) // 60
    seconds = int(timer) % 60
    output = f"Time: {minutes:02d}:{seconds:02d}"
    arcade.draw_text(output, 300, 300, arcade.color.BLACK, 30)


def create_apples():
    for _ in range(6):
        x = random.randint(5, 998)
        y = random.randint(400, 640)
        apples_in_trees_list.append([x, y])
    print(apples_in_trees_list)


def apple_falling():
    global fallen_apples_counter
    apples_in_trees_list[0][1] 


def setup():
    arcade.open_window(WIDTH, HEIGHT, "My Arcade Game")
    arcade.set_background_color(arcade.color.WHITE)
    arcade.schedule(update, 1/60)

    # Override arcade window methods
    window = arcade.get_window()
    window.on_draw = on_draw
    window.on_key_press = on_key_press
    window.on_key_release = on_key_release
    window.on_mouse_press = on_mouse_press

    create_apples()
    arcade.run()


def update(delta_time):
    global timer, player_y, player_x, up_is_being_pressed, down_is_being_pressed
    if up_is_being_pressed:
        player_y += 5
    elif down_is_being_pressed:
        player_y -= 5

    if left_pressed:
        player_x -= 5
    elif right_pressed:
        player_x += 5
    stopwatch()
    timer += delta_time

    #apple_falling()


def on_draw():
    global apple
    arcade.start_render()
    stopwatch()

    # Basket
    arcade.draw_circle_filled(player_x, player_y, 25, arcade.color.BLUE)

    # 6 Apples
    for apple in apples_in_trees_list:
        arcade.draw_circle_filled(apple[0], apple[1], 20, arcade.color.RED)


def on_key_press(key, modifiers):
    global player_y, player_x, up_is_being_pressed, down_is_being_pressed, left_pressed, right_pressed
    if key == arcade.key.UP:
        up_is_being_pressed = True
    elif key == arcade.key.DOWN:
        down_is_being_pressed = True
    if key == arcade.key.LEFT:
        left_pressed = True
    elif key == arcade.key.RIGHT:
        right_pressed = True


def on_key_release(key, modifiers):
    global player_y, player_x, up_is_being_pressed, down_is_being_pressed, left_pressed, right_pressed
    if key == arcade.key.UP:
        up_is_being_pressed = False
    elif key == arcade.key.DOWN:
        down_is_being_pressed = False
    if key == arcade.key.LEFT:
        left_pressed = False
    elif key == arcade.key.RIGHT:
        right_pressed = False



def on_mouse_press(x, y, button, modifiers):
    pass


if __name__ == '__main__':
    setup()
